## ForkJoinPool 사용시 정말 CPU 코어 갯수만큼 작업을 분할 할수 있을까?

- ForkJoinPool은 병렬처리를 위한 Java의 프레임워크로, 여러작업을 동시에 수행할 수 있지만, 실제로 처리되는 작업의 수는 CPU 코어의 개수와 비례하지 않을 수 있다.



1. **CPU 코어와 병렬성 :** 
   - ForkJoinPool은 시스템의 가용한 CPU 코어 수에 맞춰 기본적으로 병렬 스레드 풀을 생성한다.
   
   - 예를 들어, 4개의 CPU 코어가 있는 경우, 기본적으로 4개의 스레드가 생성된다.
   
2. **작업 분할 (Work Stealing) :** 
   - ForkJoinPool의 주요 특징은 작업을 작은 단위로 분할한 후, 각 스레드가 남은 작업을 가져와 실행하는 "Work Stealing" 알고리즘을 사용한다. 
   
   - 하나의 스레드가 자신의 작업을 마치면 다른 스레드의 남은 작업을 가져와 실행할 수 있다.
   - 따라서 코어 개수보다 더 많은 작업을 동시에 처리하려고 할 수 있다.
   
3. **동작 방식 :** 
   - 작업이 재귀적으로 나뉘어 각 스레드에게 할당되며, 이를 Fork와 Join 연산으로 처리한다.
   - 기본적으로 ForkJoinPool의 스레드 수는 CPU 코어 수에 의해 결정되지만, 각 스레드가 작업을 종료 할 때까지 여러작업을 처리할 수 있다.
   
4. **스레드 풀 크기 조정 :**
   -  기본적으로 ForkJoinPool은 CPU 코어 개수를 기반으로 하지만, 개발자가 직접 스레드 풀의 크기를 설정할 수 있다. 
   
   - ForkJoinPool(int parallelism) 생성자를 사용해 원하는 병렬성을 지정할 수 있다.
   
5. **스레드 오버헤드 :** 
   - CPU 코어 수보다 많은 스레드를 사용한다고 항상 성능이 향상되지는 않는다.
   - 오히려 스레드 간 컨텍스트 스위칭과 같은 오버헤드로 인해 성능이 저하될 수 있다.





## 멀티스레드 프로세스와 멀티CPU코어

1. **프로세스와 스레드의 차이**
   - **프로세스 :** 
     - 운영체제에서 자원을 할당받아 실행 중인 프로그램을 의미합니다. 각각의 프로세스는 독립적인 메모리 공간을 가지며, 다른 프로세스와 메모리를 직접 공유하지 않습니다.
   - **스레드 :** 
     - 스레드는 프로세스 내에서 실행되는 작은 작업 단위입니다. 하나의 프로세스는 여러 스레드를 가질 수 있으며, 이들은 동일한 메모르 공간을 공유합니다. (stack제외)
2. **멀티코어 CPU에서 프로세스와 스레드**
   - **멀티코어 CPU :** 
     - 현대의 CPU는 여러 코어를 가지고 있으며, 각 코어는 독립적으로 작업을 처리할 수 있습니다.
     - 즉, 동시에 여러 코어에서 다른 작업을 병렬로 실행할 수 있습니다.
   - **프로세스의 실행 :** 
     - 프로세스는 운영체제에 의해 CPU의 코어에 스케줄링됩니다. 만약 CPU가 4개의 코어를 가지고 있다면, 각 코어는 한 번에 하나의 프로세스를 실행할 수 있지만, 이들은 매우 빠르게 교체되며 동시에 여러 프로세스가 실행되는 것처럼 보입니다.
3. **멀티스레드 프로세스와 CPU코어**
   - **멀티스레드 프로세스** 
     - 하나의 프로세스가 여러 스레드를 가지고 있다면, 각 스레드는 개별적으로 스케줄링 될 수 있습니다. 즉, 운영체제는 여러 스레드를 여러 코어에 분배할 수 있습니다. 스레드가 여러 코어에서 병렬로 실행되면, 멀티코어의 성능을 최대한 활용할 수 있습니다.
   - **스레드와 코어의 관계 :** 
     - 스레드들은 동시에 여러 코어에서 실행될 수 있습니다. 즉, 하나의 프로세스에 속한 스레드들이 각각 다른 CPU 코어에서 병렬로 작업을 수행할 수 있습니다.
4. **프로세스는 하나의 코어에서만 실행되나?**
   - **아니요**, 하나의 프로세스가 여러 개의 스레드를 포함하고 있다면, 이 스레드들이 여러 CPU 코어에서 동시에 실행될 수 있습니다. 즉, 멀티스레드 프로세스는 여러 코어에서 병렬로 작업을 처리할 수 있습니다.
   - **단일 스레드 프로세스**는 일반적으로 한 번에 하나의 코어에서만 실행되며, 프로세스는 다른 코어로스케줄링될 수 있습니다. 하지만 멀티스레드 프로세스는 각 스레드가 서로 다른 코어에서 병렬로 실행될 수 있습니다.



