## Memory의 종류

<img src="./capture/Screenshot 2024-02-26 at 20.57.30.png" alt="Screenshot 2024-02-26 at 20.57.30" style="zoom: 25%;" />

- 레지스터  : 
  - 가장 빠른 기억장소로 CPU내에 존재하고 있으며 휘발성이다. (32bit 레지스터이면 32bit CPU라고 부른다.)
  - CPU는 계산을 할 때 메인메모리에 있는 값 레지스터로 가져와 계산하고 결과를 다시 메인 메모리에 저장한다.
- 캐시 :
  - 레지스터는 매우 빠르고, 그에 반해 메인메모리는 느리다.
  - 메인 메모리에 있는 값을 레지스터로 옮기려면 한참 걸리기 때문이 필요할 것 같은 데이터를 미리 가져오기로 한다.
  - 미리 가져온 데이터를 저장하는 곳이 캐시이다.
  - 캐시는 성능의 이유로 여러개를 둔다.
  - 가장 속도가 빠른 L1캐시를 보고 여기 없다면 L2캐시를 확인해 보고 여기도 없다면 메인 메모리에서 값을 가져온다.
- 메인메모리 :
  - 메인메모리는 실제 운영체제와 다른 프로세스들이 올라가는 공간이다.
  - 휘발성이다.
  - 하드디스크나 SSD보다 속도는 빠르지만 가격이 비싸기 때문에 데이터를 저장하기보다는 실행중인 프로그램만 올린다.
- 보조저장장치 (HDD,SSD) : 
  - 컴퓨터에는 사무용 프로그램이나 게임파일들을 저장할 필요가 있다.
  - 레지스터, 캐시, RAM은 휘발성이고, 가격이 비싸서 저장하기 어렵다.
  - 그래서 가격이 저렴하고 비휘발성인 보조저장장치에 파일들을 저장한다.







## 메모리와 주소

- 운영체제는 메모리를 관리하기 위해서 1바이트 크기로 구역을 나누고 숫자를 매긴다. -> 주소
- 32bit CPU => 레지스터 크기, ALU, 데이터 버스 = 32bit / 메모리 크기 = 2^32 (4GB)
- 64bit CPU => 레지스터 크기, ALU, 데이터 버스 = 64bit / 메모리 크기 = 2^64
- 64bit 속도 > 32bit 속도



### 주소

---

- 메모리를 컴퓨터에 연결하면 0번지 부터 시작하는 주소 공간이 있는데 이를 물리주소 공간이라고 한다.
- 사용자는 물리주소를 몰라도 논리주소로 물리주소에 접근할 수 있다.

<img src="./capture/Screenshot 2024-02-26 at 21.55.28.png" alt="Screenshot 2024-02-26 at 21.55.28" style="zoom: 25%;" />

- 메모리에는 운영체제와 수많은 프로세스가 올라간다. 
- 그 중에 운영체제는 특별하기 때문에 운영체제를 위한 공간은 따로 마련해둔다.
- 만약, 사용자가 악의적인 프로그램을 만들어 사용자 프로세스가 운영체제를 침범하면 굉장히 위험하다.
- 그래서 하드웨어적으로 운영체제 공간과 사용자 공간을 나누는 경계 레지스터를 만들었다.
- 경계 레지스터는 CPU내에 존재하는 레지스터로 메모리 관리자가 사용자 프로세스가 경계 레지스터의 값을 벗어났는지 검사하고, 만약 벗어났다면 그 프로세스를 종료시킨다.



### 절대주소(물리주소) 상대주소(논리주소)

---

- 메모리에는 절대주소와 상대주소라는 개념이 있다.
- 개발자는 프로그램을 만들 때 프로그램이 실행될 주소를 신경쓰지 않고 개발한다.
- 이는 컴파일러가 컴파일 할 때 메모리 0번지에서 실행한다고 가정하기 때문이다.

<img src="./capture/Screenshot 2024-02-26 at 22.01.56.png" alt="Screenshot 2024-02-26 at 22.01.56" style="zoom:25%;" />

1. 개발자의 프로그램을 실행시켜 메모리의 사용자 공간 4000번지에 올라왔다고 가정해보자.
2. 컴파일러는 0번지라고 가정해서 프로그램을 만들었고 이는 상대주소이다.
3. 실제 프로그램이 올라간 주소는 4000번지인데 이는 메모리 관리자가 바라본 절대 주소이다.
4. 만약, 사용자가 100번지에 있는 데이터를 요청하면 CPU는 메모리 관리자에게 100번지에 있는 데이터를 가져오라고 한다.
5. 메모리 관리자는 CPU가 요청한 100번지와 재배치 레지스터에 있는 4000번지의 값을 더한 4100번지에 접근해서 데이터를 가져온다.

- 이 처럼, 재배치 레지스터에는 프로그램 시작 주소가 저장되어 있다.
- 만약 시작 영역이 바뀌어 20000번지로 프로세스가 이동되어도 재배치 레지스터만 변경해주면 되기 때문에 굉장히 유연하다.